<?php
class Moto_Html_Render_Widget_HtmlWidgetModule extends Moto_Html_Render_Widget_Abstract { function _proccess($obj) { $html = ''; $content = ''; $obj = $this->initModuleData($obj); $content = $this->renderItem($obj->data); $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'content' => $content, 'widget' => Moto_Html_Util::implodeArraySimple( $this->_module ), 'widget.properties' => Moto_Html_Util::implodeArray( $this->_module->properties ), 'widget.parameters' => Moto_Html_Util::implodeArray( $this->_module->parameters ), ); $data['widget']['dataProvider'] = $obj->data->dataProvider; $data['widget']['iframeSrc'] = preg_replace('/(\.xml$)/i', '.html', $obj->data->dataProvider); if (isset($obj->data->item->options['showScrollBars']) && $obj->data->item->options['showScrollBars'] == 'true') { $data['style']['overflow'] = 'auto'; } $template = $obj->getTemplate('main'); if ($template == '') $template = $this->getTemplate('main'); $html = $this->_render($template, $data); return $html; } function renderItem($data) { $html = ''; if ($data !== null && (isset($data->item)) ) { if (isset($data->item->options['useIFrame']) && $data->item->options['useIFrame'] == 'true') { $this->_module->parameters['iframeScrolling'] = ($data->item->options['showScrollBars'] == 'true' ? 'yes' : 'no'); $this->_module->parameters['iframeStyleOverflow'] = ($data->item->options['showScrollBars'] == 'true' ? 'auto' : 'hidden'); $html = $this->_module->getTemplate('iframe'); } else { if (isset($data->item->htmlData)) $html = $data->item->htmlData; } } return $html; } }