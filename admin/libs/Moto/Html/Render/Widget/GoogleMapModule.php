<?php
class Moto_Html_Render_Widget_GoogleMapModule extends Moto_Html_Render_Widget_Abstract { function proccess($obj, $parent = null) { $this->_module = $obj; $this->_parent = $parent; $html = $this->_proccess($obj); return $html; } function _proccess($obj) { $this->_page = $this->_engine->get('page'); $html = ''; $content = ''; $obj = $this->initModuleData($obj); if ($obj->data !== null) { } $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'content' => $content, 'widget' => Moto_Html_Util::implodeArraySimple( $this->_module ), 'widget.properties' => Moto_Html_Util::implodeArray( $this->_module->properties ), 'widget.options' => (!empty($this->_module->data->configuration->options) ? Moto_Html_Util::implodeArray( $this->_module->data->configuration->options ) : array()), 'widget.parameters' => Moto_Html_Util::implodeArray( $this->_module->parameters ), ); $template = $obj->getTemplate('main'); if ($template == '') $template = $this->getTemplate('main'); $html = $this->_render($template, $data); $obj->type = ucfirst($obj->type); return $html; } function renderItems($items, $parent = 0) { $html = ''; $data = array( 'content' => '', ); $template = $this->_module->getTemplate('items'); if ($template == '') $template = '<ul>{%content%}</ul>'; foreach($items as &$item) { if ($item->parent == $parent) { $data['content'] .= $this->renderItem($item); } } $html .= $this->_render($template, $data); return $html; } function renderItem(&$item, $parent = 0) { $html = ''; $data = array( 'href' => '#', 'class' => '', 'content' => '', 'url' => '', 'action' => '', 'id' => $item->id, 'order' => $item->order, 'item' => $item, 'widget.options' => $this->_module->data->configuration->options, 'widget.properties' => $this->_module->properties, ); if ( isset($item->click) && $item->click != null) { $click = $this->getClicker()->parse($item->click, array()); $data['href'] = $click->href; $data['url'] = $click->url; $data['action'] = $click->action; if ($this->_page != null && $this->_page->url == $click->url) $data['class'] .= ($data['class'] != '' ? ' ' : '') . 'current'; } $template = $this->_module->getTemplate('item'); if ($template == '') $template = '<li class="{%class%}"><a href="{%href%}" data-url="{%url%}" data-action="{%action%}">{%label%}</a>{%content%}</li>'; if ($item->childExists()) { $data['content'] = $this->renderItems($item->getChilds(), $item->id); $classSubItems = $this->_module->getTemplate('classSubItems'); if ($classSubItems == '') $classSubItems = 'sub'; $data['class'] = $classSubItems; } $html .= $this->_render($template, $data); return $html; } }