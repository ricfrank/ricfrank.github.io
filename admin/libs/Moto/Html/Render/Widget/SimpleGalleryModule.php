<?php
 class Moto_Html_Render_Widget_SimpleGalleryModule extends Moto_Html_Render_Widget_Abstract { function proccess($obj, $parent = null) { $this->_module = $obj; $this->_parent = $parent; $html = $this->_proccess($obj, $parent); return $html; } function _proccess($obj) { $html = ''; $content = ''; $obj->type = ucfirst($obj->type); if ($obj->data !== null) $content = $this->renderItems($obj->data->items); $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'content' => $content, 'widget' => Moto_Html_Util::implodeArraySimple( $this->_module ), 'widget.properties' => Moto_Html_Util::implodeArray( $this->_module->properties ), 'widget.options' => Moto_Html_Util::implodeArray( $this->_module->data->configuration->options ), 'widget.parameters' => Moto_Html_Util::implodeArray( $this->_module->parameters ), ); $template = $obj->getTemplate('main'); if ($template == '') $template = $this->getTemplate('main'); $html = $this->_render($template, $data); $html = str_replace('background:url("") no-repeat;', '', $html); return $html; } function renderItems($items, $parent = 0) { $html = ''; $data = array( 'content' => '', ); $template = $this->_module->getTemplate('items'); if ($template == '') $template = '<ul>{%content%}</ul>'; foreach($items as $item) { if (!isset($item->parent) || $item->parent == $parent) { $data['content'] .= $this->renderItem($item); } } $html .= $this->_render($template, $data); return $html; } function renderItem($item, $parent = 0) { $html = ''; $data = array( 'label' => '', 'href' => '#', 'class' => '', 'content' => '', 'url' => '', 'action' => '', 'id' => $item->id, 'order' => $item->order, 'item' => $item, 'widget.options' => $this->_module->data->configuration->options, 'widget.properties' => $this->_module->properties, ); if ( isset($item->click) && $item->click != null) { $click = $this->getClicker()->parse($item->click, array()); $data['href'] = $click->href; $data['url'] = $click->url; $data['action'] = $click->action; } $template = $this->_module->getTemplate('item'); if ($template == '') $template = '<li class="{%class%}"><a href="{%href%}" data-url="{%url%}" data-action="{%action%}">{%label%}</a>{%content%}</li>'; $row = $this->_render($template, $data); $row = str_replace(array(' alt=""', ' title=""'), '', $row); $html .= $row; return $html; } }