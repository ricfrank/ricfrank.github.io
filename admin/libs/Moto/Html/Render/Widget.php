<?php
class Moto_Html_Render_Widget extends Moto_Html_Render_Abstract { protected $_widget = null; function proccess($obj, $parent = null) { $this->_parent = $parent; $this->_widget = $obj; $html = ''; $typeVO = $obj->getType(); if (isset($typeVO->type) && $typeVO->type != null) { $class = __CLASS__ . '_' . ucfirst($typeVO->type); $render = $this->getRenderByClass($class); if ($render != null) { $html = $render->proccess($obj, $parent); } else $html = $this->_dummyRender($obj); } else { $method_name = '_' . $typeVO->librarySymbolLinkage; if (method_exists($this, $method_name)) $html = $this->$method_name($obj, $parent); else $html = $this->_dummyRender($obj); } return $html; } protected function _dummyRender($obj) { $style = $this->getStyle($obj); $data = array( 'id' => 'widget_' . $obj->id, 'class' => $obj->getCssClass(), 'style' => $style, 'content' => '', ); $template = $this->getTemplate('main'); $html = $this->_render($template, $data); return $html; } function _ShapeSlot(SlotVO $obj) { $html = ''; $content = ''; $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'content' => $content, 'widget' => $obj ); if (isset($obj->properties['fitStageWidth']['value']) && $obj->properties['fitStageWidth']['value'] == 'true') { $data['class'] .= ' ' . $this->_cssPref . 'auto-width-window'; } if (isset($obj->properties['fitStageHeight']['value']) && $obj->properties['fitStageHeight']['value'] == 'true') { $data['class'] .= ' ' . $this->_cssPref . 'auto-height-window'; } $mainStyleTemplate = $obj->getTemplate('mainStyle'); if ($mainStyleTemplate != '') { $style = $this->prepareStyle($style); if (1==11) { $style .= $this->_render($mainStyleTemplate, $obj->properties); $style = str_replace('#0x', '#', $style); } else { $style .= $mainStyleTemplate; } $data['style'] = $style; } $template = $obj->getTemplate(); if ($template == '') $template = $this->getTemplate(); $html .= $this->_render($template, $data); return $html; } function _TextSlot($obj) { $html = ''; $content = __CLASS__ . ' -> ' . __FUNCTION__; $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'content' => $content, ); $template = $obj->getTemplate(); if ($template == '') $template = $this->getTemplate(); $html = $this->_render($template, $data); return $html; } function _GalleryPageImageSlot(SlotVO $obj) { $html = ''; $content = __CLASS__ . ' -> ' . __FUNCTION__; $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'content' => $content, 'widget' => Moto_Html_Util::implodeArraySimple( $obj ), 'widget.properties' => Moto_Html_Util::implodeArray( $obj->properties ), ); $template = $obj->getTemplate(); if ($template == '') $template = $this->getTemplate(); $html = $this->_render($template, $data); $html = str_replace('#0x', '#', $html); return $html; } function _BGImageSlot(SlotVO $obj) { $html = ''; $style = $this->getStyle($obj); $content = ''; $data = array( 'id' => 'widget_' . $obj->id, 'class' => $this->getCssClass($obj), 'style' => $this->getStyle($obj), 'widget' => Moto_Html_Util::implodeArraySimple( $obj ), 'widget.properties' => Moto_Html_Util::implodeArray( $obj->properties ), ); $template = $obj->getTemplate(); if ($template == '') $template = $this->getTemplate(); $html = $this->_render($template, $data); return $html; } }