<?php
class Moto_Html_HolderVO { protected $_data = array(); function __construct($data = null) { if (is_array($data)) $this->setFromArray ($data); } function __set($name, $value) { $this->_data[$name] = $value; } function __isset($name) { return (isset($this->_data[$name])); } function __get($name) { return ( isset($this->_data[$name]) ? $this->_data[$name] : null ); } function loadElements($dom, $page) { switch($this->type) { case 'website': $this->_loadWebsite($dom); break; case 'layout': $this->_loadLayout($dom); break; case 'page': $this->_loadPage($page); break; } } function _loadWebsite($parent) { $query = './website/objects/object[@holder=' . $this->id . ']'; $this->objects = ObjectVO::findAllByExpression($parent, $query); $query = './website/slots/slot[@holder=' . $this->id . ']'; $this->slots = SlotVO::findAllByExpression($parent, $query); $query = './website/modules/module[@holder=' . $this->id . ']'; $this->modules = ModuleVO::findAllByExpression($parent, $query); } function _loadPage($page) { $parent = $page->getNode(); $query = './objects/object[@holder=' . $this->id . ']'; $this->objects = ObjectVO::findAllByExpression($parent, $query); $query = './slots/slot[@holder=' . $this->id . ']'; $this->slots = SlotVO::findAllByExpression($parent, $query); $query = './modules/module[@holder=' . $this->id . ']'; $this->modules = ModuleVO::findAllByExpression($parent, $query); } function _loadLayout($parent) { $_query = './layouts/layout[@layoutType='.$this->parentId.']/'; $query = $_query . 'objects/object[@holder=' . $this->id . ']'; $this->objects = ObjectVO::findAllByExpression($parent, $query); $query = $_query . 'slots/slot[@holder=' . $this->id . ']'; $this->slots = SlotVO::findAllByExpression($parent, $query); $query = $_query . 'modules/module[@holder=' . $this->id . ']'; $this->modules = ModuleVO::findAllByExpression($parent, $query); } function setElements($section, $data) { $this->$section = $data; return $this; } function setFromArray($data) { $this->_data = array_merge($this->_data, $data); } function getJsObj() { return $this->_data; } }