<?php
 class RemoteWidgetsManagerVO extends WidgetsManagerVO { protected $_params = array( 'server' => 'http://components.motocms.com/', 'point' => '', 'widgets' => 'widgets', 'root' => MOTO_ROOT_DIR, ); function __construct($params = null) { if (!defined('REMOTE_WIDGET_SERVICE_POINT')) define ('REMOTE_WIDGET_SERVICE_POINT', 'http://components.motocms.com/xmlrpc_server.php'); $this->_params['point'] = REMOTE_WIDGET_SERVICE_POINT; $info = parse_url(REMOTE_WIDGET_SERVICE_POINT); $this->_params['server'] = $info['scheme'] . '://' . $info['host'] . '/widgets'; if (is_array($params)) $this->_params = array_merge ($this->_params, $params); } public function getList($request) { $this->getParameters(); $client = new MotoXmlRpc(REMOTE_WIDGET_SERVICE_POINT); $result = $client->sendRequest('WidgetsService.getList', $request); $this->widgets = array(); if (is_array($result)) foreach($result as $widget) { $widgetVO = new RemoteWidgetVO(); foreach($widget as $key => $name) { $widgetVO->$key = $name; } $widgetVO->renderRefNames($this->_params); $this->widgets[] = $widgetVO; } return $result; } }